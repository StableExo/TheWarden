# Contract Verification Files

## ‚ö†Ô∏è **STOP! Read This First!** ‚ö†Ô∏è

### Are you getting a "ParserError" on BaseScan?

**üëâ READ: [`IMPORTANT_READ_FIRST.md`](./IMPORTANT_READ_FIRST.md) üëà**

Common mistakes:
- Pasting constructor arguments into the source code field
- **Mixed line endings (CRLF/LF) in the flattened file** - See [`LINE_ENDINGS_FIX.md`](./LINE_ENDINGS_FIX.md)

---

This directory contains all the materials needed to verify the FlashSwapV2 and FlashSwapV3 contracts on BaseScan.

## üéØ Recommended Verification Methods

### 1. ‚ö° Foundry Method (Fastest & Easiest)

**Best for**: Automated verification with one command

```bash
npm run verify:foundry
```

See: [`docs/FOUNDRY_CONTRACT_VERIFICATION.md`](../docs/FOUNDRY_CONTRACT_VERIFICATION.md)

### 2. üì¶ GitHub Gist Method

**Best for**: Large contracts (when Foundry fails)

```bash
npm run verify:upload-gist
```

See: [`docs/CONTRACT_VERIFICATION_WITH_GIST.md`](../docs/CONTRACT_VERIFICATION_WITH_GIST.md)

### 3. ‚úã Manual Method

**Best for**: When automated methods fail

See: Instructions below

---

## Files

### FlashSwapV2
- `FlashSwapV2_flattened.sol` - Flattened contract source code (2,070 lines)
- `FlashSwapV2_constructor_args.txt` - ABI-encoded constructor arguments

### FlashSwapV3
- `FlashSwapV3_flattened.sol` - Flattened contract source code (2,313 lines)
- `FlashSwapV3_constructor_args.txt` - ABI-encoded constructor arguments

### Gist Files (Generated)
- `GIST_URLS.md` - GitHub Gist URLs for verification (generated by `npm run verify:upload-gist`)

## üöÄ Method 2: Upload to Gist (For Large Contracts)

**‚ö†Ô∏è IMPORTANT:** These contracts are **too large** to paste directly into BaseScan's verification form. Use GitHub Gist instead!

### Setup

```bash
# 1. Install Node.js 22 and dependencies
nvm install 22 && nvm use 22 && npm install

# 2. Add GitHub token to .env (needs 'gist' scope)
# Generate at: https://github.com/settings/tokens/new
# Check ONLY the "gist" scope
# Then add to .env:
GITHUB_TOKEN=ghp_your_token_here
```

**‚ö†Ô∏è Getting a 403 error?** Your token needs the "gist" scope!
See: [`../scripts/verification/GITHUB_TOKEN_SETUP.md`](../scripts/verification/GITHUB_TOKEN_SETUP.md)

### One-Command Solution

```bash
# Upload contracts to GitHub Gist and generate verification URLs
npm run verify:upload-gist
```

This will:
1. Create a public GitHub Gist with all verification files
2. Generate `GIST_URLS.md` with complete verification instructions
3. Provide direct links to BaseScan verification pages

**Prerequisites:**
- Set `GITHUB_TOKEN` in `.env` with a token that has the `gist` scope
- **Need help?** See: [`../scripts/verification/GITHUB_TOKEN_SETUP.md`](../scripts/verification/GITHUB_TOKEN_SETUP.md)

**After running:**
- Open `GIST_URLS.md` for step-by-step verification instructions
- Use the Gist raw URLs in BaseScan's verification form

---

## Alternative: Manual Verification

### How to Use

### Quick Verification

1. **Visit the verification URL for each contract:**
   - FlashSwapV2: https://basescan.org/verifyContract?a=0x6e2473E4BEFb66618962f8c332706F8f8d339c08
   - FlashSwapV3: https://basescan.org/verifyContract?a=0x4926E08c0aF3307Ea7840855515b22596D39F7eb

2. **Enter settings:**
   - Compiler Type: Solidity (Single file)
   - Compiler Version: v0.8.20+commit.a1b79de6
   - License: MIT License (MIT)

3. **Paste the flattened source code:**
   - For V2: Copy contents of `FlashSwapV2_flattened.sol`
   - For V3: Copy contents of `FlashSwapV3_flattened.sol`

4. **Set optimization:**
   - Optimization: Yes
   - Runs: 200
   - EVM Version: shanghai

5. **Paste constructor arguments:**
   - For V2: Copy contents of `FlashSwapV2_constructor_args.txt`
   - For V3: Copy contents of `FlashSwapV3_constructor_args.txt`

6. **Submit** - Click "Verify and Publish"

### Command Line Copy

```bash
# macOS - Copy flattened source to clipboard (one at a time)
cat FlashSwapV2_flattened.sol | pbcopy    # For V2
# OR
cat FlashSwapV3_flattened.sol | pbcopy    # For V3

# Linux - Copy flattened source to clipboard (one at a time)
cat FlashSwapV2_flattened.sol | xclip -selection clipboard    # For V2
# OR
cat FlashSwapV3_flattened.sol | xclip -selection clipboard    # For V3

# View constructor args
cat FlashSwapV2_constructor_args.txt
cat FlashSwapV3_constructor_args.txt
```

## Regenerate Files

If you need to regenerate these files:

```bash
npm run verify:autonomous
```

This will:
- Check verification status
- Flatten contracts again
- Regenerate constructor arguments
- Update all files in this directory

## Verification URLs

- **FlashSwapV2**: https://basescan.org/verifyContract?a=0x6e2473E4BEFb66618962f8c332706F8f8d339c08
- **FlashSwapV3**: https://basescan.org/verifyContract?a=0x4926E08c0aF3307Ea7840855515b22596D39F7eb

## After Verification

Once verified, contracts will be viewable at:
- **FlashSwapV2**: https://basescan.org/address/0x6e2473E4BEFb66618962f8c332706F8f8d339c08#code
- **FlashSwapV3**: https://basescan.org/address/0x4926E08c0aF3307Ea7840855515b22596D39F7eb#code

## Need Help?

See the complete guide: `../docs/CONTRACT_VERIFICATION_GUIDE.md`
